{"version":3,"file":"bundle.cjs","sources":["../src/common.ts","../src/scroll-step.ts","../src/scroll.ts","../src/scrollIntoView.ts","../src/scroll.polyfill.ts","../src/scrollIntoView.polyfill.ts","../src/polyfill.ts"],"sourcesContent":["import type { IScrollConfig } from \"./scroll-step\";\n\nexport const checkBehavior = (behavior?: string): behavior is undefined | ScrollBehavior => {\n    return behavior === undefined || behavior === \"auto\" || behavior === \"instant\" || behavior === \"smooth\";\n};\n\nexport function elementScrollXY(this: Element, x: number, y: number): void {\n    this.scrollLeft = x;\n    this.scrollTop = y;\n}\n\nexport const failedExecute = (method: string, object: string, reason = \"cannot convert to dictionary.\"): string =>\n    `Failed to execute '${method}' on '${object}': ${reason}`;\n\nexport const failedExecuteInvalidEnumValue = (method: string, object: string, value: string): string =>\n    failedExecute(method, object, `The provided value '${value}' is not a valid enum value of type ScrollBehavior.`);\n\ninterface BackupMethod {\n    <K extends keyof Element>(proto: Element, method: K): Element[K] | undefined;\n    <K extends keyof Element>(proto: Element, method: K, fallback: unknown): Element[K];\n    <K extends keyof Window>(proto: Window, method: K): Window[K] | undefined;\n    <K extends keyof Window>(proto: Window, method: K, fallback: unknown): Window[K];\n}\n\n/* eslint-disable */\nexport const backupMethod: BackupMethod = (proto: any, method: string, fallback?: unknown) => {\n    const backup = `__SEAMLESS.BACKUP$${method}`;\n\n    if (!proto[backup] && proto[method] && !proto[method]?.__isPolyfill) {\n        proto[backup] = proto[method];\n    }\n\n    return proto[backup] || fallback;\n};\n/* eslint-enable */\n\nexport const isObject = (value: unknown): boolean => {\n    const type = typeof value;\n    return value !== null && (type === \"object\" || type === \"function\");\n};\n\nexport const isScrollBehaviorSupported = (config?: IScrollConfig): boolean =>\n    \"scrollBehavior\" in window.document.documentElement.style && config?.forcePolyfill !== true;\n\nexport const markPolyfill = (method: () => void): void => {\n    Object.defineProperty(method, \"__isPolyfill\", { value: true });\n};\n\ntype Prototype = typeof HTMLElement.prototype | typeof SVGElement.prototype | typeof Element.prototype;\n\nexport const modifyPrototypes = <T extends \"scroll\" | \"scrollTo\" | \"scrollBy\" | \"scrollIntoView\">(\n    prop: T,\n    func: Prototype[T],\n): void => {\n    markPolyfill(func);\n    [HTMLElement.prototype, SVGElement.prototype, Element.prototype].forEach((prototype) => {\n        backupMethod(prototype, prop);\n        prototype[prop] = func;\n    });\n};\n\n/**\n * - On Chrome and Firefox, document.scrollingElement will return the <html> element.\n * - Safari, document.scrollingElement will return the <body> element.\n * - On Edge, document.scrollingElement will return the <body> element.\n * - IE11 does not support document.scrollingElement, but you can assume its <html>.\n */\nexport const scrollingElement = (element: Element): Element =>\n    element.ownerDocument.scrollingElement || element.ownerDocument.documentElement;\n","export interface IScrollConfig {\n    readonly duration?: number;\n    readonly forcePolyfill?: boolean;\n    readonly timingFunc?: (k: number) => number;\n}\n\nexport interface IContext extends IScrollConfig {\n    readonly timeStamp: number;\n    readonly startX: number;\n    readonly startY: number;\n    readonly targetX: number;\n    readonly targetY: number;\n    readonly method: (x: number, y: number) => void;\n    readonly callback: () => void;\n    rafId: number;\n}\n\nconst ease = (k: number) => {\n    return 0.5 * (1 - Math.cos(Math.PI * k));\n};\n\n/* eslint-disable */\nexport function now(): number {\n    let fn: () => number;\n    if (window.performance?.now) {\n        fn = () => window.performance.now();\n    } else {\n        fn = () => window.Date.now();\n    }\n\n    // @ts-ignore\n    now = fn;\n    return fn();\n}\n/* eslint-enable */\n\nconst DURATION = 500;\n\nexport const step = (context: IContext): void => {\n    const currentTime = now();\n\n    const elapsed = (currentTime - context.timeStamp) / (context.duration || DURATION);\n    if (elapsed > 1) {\n        context.method(context.targetX, context.targetY);\n        context.callback();\n        return;\n    }\n    const value = (context.timingFunc || ease)(elapsed);\n\n    const currentX = context.startX + (context.targetX - context.startX) * value;\n    const currentY = context.startY + (context.targetY - context.startY) * value;\n\n    context.method(currentX, currentY);\n\n    context.rafId = window.requestAnimationFrame(() => {\n        step(context);\n    });\n};\n","import {\n    backupMethod,\n    checkBehavior,\n    elementScrollXY,\n    failedExecute,\n    failedExecuteInvalidEnumValue,\n    isObject,\n    scrollingElement,\n} from \"./common.js\";\nimport type { IContext, IScrollConfig } from \"./scroll-step\";\nimport { now, step } from \"./scroll-step.js\";\n\n// https://drafts.csswg.org/cssom-view/#normalize-non-finite-values\nconst nonFinite = (value: unknown): number => {\n    if (!isFinite(value as number)) {\n        return 0;\n    }\n    return Number(value);\n};\n\nconst isConnected = (node: Node) => {\n    return (\n        node.isConnected ??\n        (!node.ownerDocument ||\n            // eslint-disable-next-line no-bitwise\n            !(node.ownerDocument.compareDocumentPosition(node) & /** DOCUMENT_POSITION_DISCONNECTED */ 1))\n    );\n};\n\nconst scrollWithOptions = (element: Element, options: Readonly<ScrollToOptions>, config?: IScrollConfig): void => {\n    if (!isConnected(element)) {\n        return;\n    }\n\n    const startX = element.scrollLeft;\n    const startY = element.scrollTop;\n\n    const targetX = nonFinite(options.left ?? startX);\n    const targetY = nonFinite(options.top ?? startY);\n\n    if (targetX === startX && targetY === startY) {\n        return;\n    }\n\n    const fallback = backupMethod(HTMLElement.prototype, \"scroll\", elementScrollXY);\n    const method = backupMethod(Object.getPrototypeOf(element) as Element, \"scroll\", fallback).bind(element);\n\n    if (options.behavior !== \"smooth\") {\n        method(targetX, targetY);\n        return;\n    }\n\n    const removeEventListener = () => {\n        window.removeEventListener(\"wheel\", cancelScroll);\n        window.removeEventListener(\"touchmove\", cancelScroll);\n    };\n\n    const context: IContext = {\n        ...config,\n        timeStamp: now(),\n        startX,\n        startY,\n        targetX,\n        targetY,\n        rafId: 0,\n        method,\n        callback: removeEventListener,\n    };\n\n    const cancelScroll = () => {\n        window.cancelAnimationFrame(context.rafId);\n        removeEventListener();\n    };\n\n    window.addEventListener(\"wheel\", cancelScroll, {\n        passive: true,\n        once: true,\n    });\n    window.addEventListener(\"touchmove\", cancelScroll, {\n        passive: true,\n        once: true,\n    });\n\n    step(context);\n};\n\nconst isWindow = (obj: unknown): obj is Window => (obj as Window).window === obj;\n\ninterface ScrollMethod<T extends Element | typeof window> {\n    (target: T, scrollOptions?: ScrollToOptions, config?: IScrollConfig): void;\n}\n\nconst createScroll =\n    <T extends Element | typeof window>(scrollName: \"scroll\" | \"scrollTo\" | \"scrollBy\"): ScrollMethod<T> =>\n    (target, scrollOptions, config): void => {\n        const [element, scrollType]: [Element, \"Window\" | \"Element\"] = isWindow(target)\n            ? [scrollingElement(target.document.documentElement), \"Window\"]\n            : [target, \"Element\"];\n\n        const options = scrollOptions ?? {};\n\n        if (!isObject(options)) {\n            throw new TypeError(failedExecute(scrollName, scrollType));\n        }\n\n        if (!checkBehavior(options.behavior)) {\n            throw new TypeError(failedExecuteInvalidEnumValue(scrollName, scrollType, options.behavior));\n        }\n\n        if (scrollName === \"scrollBy\") {\n            options.left = nonFinite(options.left) + element.scrollLeft;\n            options.top = nonFinite(options.top) + element.scrollTop;\n        }\n\n        scrollWithOptions(element, options, config);\n    };\n\nexport const scroll = /* #__PURE__ */ createScroll(\"scroll\");\nexport const scrollTo = /* #__PURE__ */ createScroll(\"scrollTo\");\nexport const scrollBy = /* #__PURE__ */ createScroll(\"scrollBy\");\n\nexport const elementScroll = scroll as ScrollMethod<Element>;\nexport const elementScrollTo = scrollTo as ScrollMethod<Element>;\nexport const elementScrollBy = scrollBy as ScrollMethod<Element>;\n\nexport const windowScroll = scroll as ScrollMethod<typeof window>;\nexport const windowScrollTo = scrollTo as ScrollMethod<typeof window>;\nexport const windowScrollBy = scrollBy as ScrollMethod<typeof window>;\n","/* eslint-disable no-bitwise */\nimport { checkBehavior, failedExecuteInvalidEnumValue, scrollingElement } from \"./common.js\";\nimport type { IScrollConfig } from \"./scroll-step\";\nimport { elementScroll } from \"./scroll.js\";\n\nconst enum ScrollAlignment {\n    ToEdgeIfNeeded,\n    CenterAlways,\n    LeftOrTop,\n    RightOrBottom,\n}\n\nconst enum WritingMode {\n    HorizontalTb,\n    VerticalRl,\n    VerticalLr,\n    SidewaysRl,\n    SidewaysLr,\n}\n\n// https://drafts.csswg.org/css-writing-modes-4/#block-flow\nconst normalizeWritingMode = (writingMode: string): WritingMode => {\n    switch (writingMode) {\n        case \"horizontal-tb\":\n        case \"lr\":\n        case \"lr-tb\":\n        case \"rl\":\n        case \"rl-tb\":\n            return WritingMode.HorizontalTb;\n\n        case \"vertical-rl\":\n        case \"tb\":\n        case \"tb-rl\":\n            return WritingMode.VerticalRl;\n\n        case \"vertical-lr\":\n        case \"tb-lr\":\n            return WritingMode.VerticalLr;\n\n        case \"sideways-rl\":\n            return WritingMode.SidewaysRl;\n\n        case \"sideways-lr\":\n            return WritingMode.SidewaysLr;\n    }\n\n    return WritingMode.HorizontalTb;\n};\n\ntype Tuple2<T> = [T, T];\n\nconst calcPhysicalAxis = <T>(writingMode: WritingMode, isLTR: boolean, hPos: T, vPos: T): [number, T, T] => {\n    /**  0b{vertical}{horizontal}  0: normal, 1: reverse */\n    let layout = 0b00;\n\n    const enum OP {\n        ReverseHorizontal = 0b01,\n        ReverseVertical = 0b10,\n    }\n\n    /**\n     * WritingMode.VerticalLr: ↓→\n     * | 1 | 4 |   |\n     * | 2 | 5 |   |\n     * | 3 |   |   |\n     *\n     * RTL: ↑→\n     * | 3 |   |   |\n     * | 2 | 5 |   |\n     * | 1 | 4 |   |\n     */\n    if (!isLTR) {\n        layout ^= OP.ReverseVertical;\n    }\n\n    switch (writingMode) {\n        /**\n         * ↓→\n         * | 1 | 2 | 3 |\n         * | 4 | 5 |   |\n         * |   |   |   |\n         *\n         * RTL: ↓←\n         * | 3 | 2 | 1 |\n         * |   | 5 | 4 |\n         * |   |   |   |\n         */\n        case WritingMode.HorizontalTb:\n            // swap horizontal and vertical\n            layout = (layout >> 1) | ((layout & 1) << 1);\n            [hPos, vPos] = [vPos, hPos];\n            break;\n\n        /**\n         * ↓←\n         * |   | 4 | 1 |\n         * |   | 5 | 2 |\n         * |   |   | 3 |\n         *\n         * RTL: ↑←\n         * |   |   | 3 |\n         * |   | 5 | 2 |\n         * |   | 4 | 1 |\n         */\n        case WritingMode.VerticalRl:\n        case WritingMode.SidewaysRl:\n            //  reverse horizontal\n            layout ^= OP.ReverseHorizontal;\n            break;\n\n        /**\n         * ↑→\n         * | 3 |   |   |\n         * | 2 | 5 |   |\n         * | 1 | 4 |   |\n         *\n         * RTL: ↓→\n         * | 1 | 4 |   |\n         * | 2 | 5 |   |\n         * | 3 |   |   |\n         */\n        case WritingMode.SidewaysLr:\n            // reverse vertical\n            layout ^= OP.ReverseVertical;\n            break;\n    }\n\n    return [layout, hPos, vPos];\n};\n\nconst isXReversed = (computedStyle: Readonly<CSSStyleDeclaration>): boolean => {\n    const layout = calcPhysicalAxis(\n        normalizeWritingMode(computedStyle.writingMode),\n        computedStyle.direction !== \"rtl\",\n        undefined,\n        undefined,\n    )[0];\n    return (layout & 1) === 1;\n};\n\n// https://source.chromium.org/chromium/chromium/src/+/main:third_party/blink/renderer/core/dom/element.cc;l=1097-1189;drc=6a7533d4a1e9f2372223a9d912a9e53a6fa35ae0\nconst toPhysicalAlignment = (\n    options: Readonly<ScrollIntoViewOptions>,\n    writingMode: WritingMode,\n    isLTR: boolean,\n): Tuple2<ScrollAlignment> => {\n    const [layout, hPos, vPos] = calcPhysicalAxis(\n        writingMode,\n        isLTR,\n        options.block || \"start\",\n        options.inline || \"nearest\",\n    );\n\n    return [hPos, vPos].map((value, index) => {\n        switch (value) {\n            case \"center\":\n                return ScrollAlignment.CenterAlways;\n            case \"nearest\":\n                return ScrollAlignment.ToEdgeIfNeeded;\n\n            default: {\n                const reverse = (layout >> index) & 1;\n                return (value === \"start\") === !reverse ? ScrollAlignment.LeftOrTop : ScrollAlignment.RightOrBottom;\n            }\n        }\n    }) as Tuple2<ScrollAlignment>;\n};\n\n// code from stipsan/compute-scroll-into-view\n// https://github.com/stipsan/compute-scroll-into-view/blob/5396c6b78af5d0bbce11a7c4e93cc3146546fcd3/src/index.ts\n/**\n * Find out which edge to align against when logical scroll position is \"nearest\"\n * Interesting fact: \"nearest\" works similarily to \"if-needed\", if the element is fully visible it will not scroll it\n *\n * Legends:\n * ┌────────┐ ┏ ━ ━ ━ ┓\n * │ target │   frame\n * └────────┘ ┗ ━ ━ ━ ┛\n */\nconst mapNearest = (\n    align: ScrollAlignment,\n    scrollingEdgeStart: number,\n    scrollingEdgeEnd: number,\n    scrollingSize: number,\n    elementEdgeStart: number,\n    elementEdgeEnd: number,\n    elementSize: number,\n): Exclude<ScrollAlignment, ScrollAlignment.ToEdgeIfNeeded> | null => {\n    if (align !== ScrollAlignment.ToEdgeIfNeeded) {\n        return align;\n    }\n\n    /**\n     * If element edge A and element edge B are both outside scrolling box edge A and scrolling box edge B\n     *\n     *          ┌──┐\n     *        ┏━│━━│━┓\n     *          │  │\n     *        ┃ │  │ ┃        do nothing\n     *          │  │\n     *        ┗━│━━│━┛\n     *          └──┘\n     *\n     *  If element edge C and element edge D are both outside scrolling box edge C and scrolling box edge D\n     *\n     *    ┏ ━ ━ ━ ━ ┓\n     *   ┌───────────┐\n     *   │┃         ┃│        do nothing\n     *   └───────────┘\n     *    ┗ ━ ━ ━ ━ ┛\n     */\n    if (\n        (elementEdgeStart < scrollingEdgeStart && elementEdgeEnd > scrollingEdgeEnd) ||\n        (elementEdgeStart > scrollingEdgeStart && elementEdgeEnd < scrollingEdgeEnd)\n    ) {\n        return null;\n    }\n\n    /**\n     * If element edge A is outside scrolling box edge A and element height is less than scrolling box height\n     *\n     *          ┌──┐\n     *        ┏━│━━│━┓         ┏━┌━━┐━┓\n     *          └──┘             │  │\n     *  from  ┃      ┃     to  ┃ └──┘ ┃\n     *\n     *        ┗━ ━━ ━┛         ┗━ ━━ ━┛\n     *\n     * If element edge B is outside scrolling box edge B and element height is greater than scrolling box height\n     *\n     *        ┏━ ━━ ━┓         ┏━┌━━┐━┓\n     *                           │  │\n     *  from  ┃ ┌──┐ ┃     to  ┃ │  │ ┃\n     *          │  │             │  │\n     *        ┗━│━━│━┛         ┗━│━━│━┛\n     *          │  │             └──┘\n     *          │  │\n     *          └──┘\n     *\n     * If element edge C is outside scrolling box edge C and element width is less than scrolling box width\n     *\n     *       from                 to\n     *    ┏ ━ ━ ━ ━ ┓         ┏ ━ ━ ━ ━ ┓\n     *  ┌───┐                 ┌───┐\n     *  │ ┃ │       ┃         ┃   │     ┃\n     *  └───┘                 └───┘\n     *    ┗ ━ ━ ━ ━ ┛         ┗ ━ ━ ━ ━ ┛\n     *\n     * If element edge D is outside scrolling box edge D and element width is greater than scrolling box width\n     *\n     *       from                 to\n     *    ┏ ━ ━ ━ ━ ┓         ┏ ━ ━ ━ ━ ┓\n     *        ┌───────────┐   ┌───────────┐\n     *    ┃   │     ┃     │   ┃         ┃ │\n     *        └───────────┘   └───────────┘\n     *    ┗ ━ ━ ━ ━ ┛         ┗ ━ ━ ━ ━ ┛\n     */\n    if (\n        (elementEdgeStart <= scrollingEdgeStart && elementSize <= scrollingSize) ||\n        (elementEdgeEnd >= scrollingEdgeEnd && elementSize >= scrollingSize)\n    ) {\n        return ScrollAlignment.LeftOrTop;\n    }\n\n    /**\n     * If element edge B is outside scrolling box edge B and element height is less than scrolling box height\n     *\n     *        ┏━ ━━ ━┓         ┏━ ━━ ━┓\n     *\n     *  from  ┃      ┃     to  ┃ ┌──┐ ┃\n     *          ┌──┐             │  │\n     *        ┗━│━━│━┛         ┗━└━━┘━┛\n     *          └──┘\n     *\n     * If element edge A is outside scrolling box edge A and element height is greater than scrolling box height\n     *\n     *          ┌──┐\n     *          │  │\n     *          │  │             ┌──┐\n     *        ┏━│━━│━┓         ┏━│━━│━┓\n     *          │  │             │  │\n     *  from  ┃ └──┘ ┃     to  ┃ │  │ ┃\n     *                           │  │\n     *        ┗━ ━━ ━┛         ┗━└━━┘━┛\n     *\n     * If element edge C is outside scrolling box edge C and element width is greater than scrolling box width\n     *\n     *           from                 to\n     *        ┏ ━ ━ ━ ━ ┓         ┏ ━ ━ ━ ━ ┓\n     *  ┌───────────┐           ┌───────────┐\n     *  │     ┃     │   ┃       │ ┃         ┃\n     *  └───────────┘           └───────────┘\n     *        ┗ ━ ━ ━ ━ ┛         ┗ ━ ━ ━ ━ ┛\n     *\n     * If element edge D is outside scrolling box edge D and element width is less than scrolling box width\n     *\n     *           from                 to\n     *        ┏ ━ ━ ━ ━ ┓         ┏ ━ ━ ━ ━ ┓\n     *                ┌───┐             ┌───┐\n     *        ┃       │ ┃ │       ┃     │   ┃\n     *                └───┘             └───┘\n     *        ┗ ━ ━ ━ ━ ┛         ┗ ━ ━ ━ ━ ┛\n     *\n     */\n    if (\n        (elementEdgeEnd > scrollingEdgeEnd && elementSize < scrollingSize) ||\n        (elementEdgeStart < scrollingEdgeStart && elementSize > scrollingSize)\n    ) {\n        return ScrollAlignment.RightOrBottom;\n    }\n\n    return null;\n};\n\nconst canOverflow = (overflow: string | null): boolean => {\n    return overflow !== \"visible\" && overflow !== \"clip\";\n};\n\nconst getFrameElement = (element: Element): Element | null => {\n    try {\n        return element.ownerDocument.defaultView?.frameElement || null;\n    } catch {\n        return null;\n    }\n};\n\nconst isScrollable = (element: Element, computedStyle: Readonly<CSSStyleDeclaration>): boolean => {\n    if (element.clientHeight < element.scrollHeight || element.clientWidth < element.scrollWidth) {\n        return (\n            canOverflow(computedStyle.overflowY) ||\n            canOverflow(computedStyle.overflowX) ||\n            element === scrollingElement(element)\n        );\n    }\n\n    return false;\n};\n\nconst parentElement = (element: Element): Element | null => {\n    const pNode = element.parentNode;\n    const pElement = element.parentElement;\n\n    if (pElement === null && pNode !== null) {\n        if (pNode.nodeType === /** Node.DOCUMENT_FRAGMENT_NODE */ 11) {\n            return (pNode as ShadowRoot).host;\n        }\n        if (pNode.nodeType === /** Node.DOCUMENT_NODE */ 9) {\n            return getFrameElement(element);\n        }\n    }\n\n    return pElement;\n};\n\nconst clamp = (value: number, min: number, max: number): number => {\n    if (value < min) {\n        return min;\n    }\n\n    if (value > max) {\n        return max;\n    }\n\n    return value;\n};\n\nconst getSupportedScrollMarginProperty = (\n    ownerDocument: Document,\n): \"scroll-margin\" | \"scroll-snap-margin\" | undefined => {\n    // Webkit uses \"scroll-snap-margin\" https://bugs.webkit.org/show_bug.cgi?id=189265.\n    return ([\"scroll-margin\", \"scroll-snap-margin\"] as const).filter(\n        (property) => property in ownerDocument.documentElement.style,\n    )[0];\n};\n\nconst getElementScrollSnapArea = (\n    element: Element,\n    elementRect: Readonly<DOMRect>,\n    computedStyle: Readonly<CSSStyleDeclaration>,\n): [top: number, right: number, bottom: number, left: number] => {\n    const { top, right, bottom, left } = elementRect;\n    const scrollProperty = getSupportedScrollMarginProperty(element.ownerDocument);\n    if (!scrollProperty) {\n        return [top, right, bottom, left];\n    }\n\n    const scrollMarginValue = (edge: \"top\" | \"right\" | \"bottom\" | \"left\"): number => {\n        const value = computedStyle.getPropertyValue(`${scrollProperty}-${edge}`);\n        return parseInt(value, 10) || 0;\n    };\n\n    return [\n        top - scrollMarginValue(\"top\"),\n        right + scrollMarginValue(\"right\"),\n        bottom + scrollMarginValue(\"bottom\"),\n        left - scrollMarginValue(\"left\"),\n    ];\n};\n\nconst calcAlignEdge = (align: ScrollAlignment, start: number, end: number): number => {\n    switch (align) {\n        case ScrollAlignment.CenterAlways:\n            return (start + end) / 2;\n\n        case ScrollAlignment.RightOrBottom:\n            return end;\n\n        case ScrollAlignment.LeftOrTop:\n        case ScrollAlignment.ToEdgeIfNeeded:\n            return start;\n    }\n};\n\nconst getFrameViewport = (frame: Element, frameRect: Readonly<DOMRect>) => {\n    const visualViewport = frame.ownerDocument.defaultView?.visualViewport;\n    const [x, y, width, height] =\n        frame === scrollingElement(frame)\n            ? [0, 0, visualViewport?.width ?? frame.clientWidth, visualViewport?.height ?? frame.clientHeight]\n            : [frameRect.left, frameRect.top, frame.clientWidth, frame.clientHeight];\n\n    const left = x + frame.clientLeft;\n    const top = y + frame.clientTop;\n    const right = left + width;\n    const bottom = top + height;\n\n    return [top, right, bottom, left] as const;\n};\n\nconst computeScrollIntoView = (element: Element, options: ScrollIntoViewOptions): [Element, ScrollToOptions][] => {\n    // Collect all the scrolling boxes, as defined in the spec: https://drafts.csswg.org/cssom-view/#scrolling-box\n    const actions: [Element, ScrollToOptions][] = [];\n\n    let ownerDocument = element.ownerDocument;\n    let ownerWindow = ownerDocument.defaultView;\n\n    if (!ownerWindow) {\n        return actions;\n    }\n\n    const computedStyle = window.getComputedStyle(element);\n    const isLTR = computedStyle.direction !== \"rtl\";\n\n    const writingMode = normalizeWritingMode(\n        computedStyle.writingMode ||\n            computedStyle.getPropertyValue(\"-webkit-writing-mode\") ||\n            computedStyle.getPropertyValue(\"-ms-writing-mode\"),\n    );\n\n    const [alignH, alignV] = toPhysicalAlignment(options, writingMode, isLTR);\n\n    let [top, right, bottom, left] = getElementScrollSnapArea(element, element.getBoundingClientRect(), computedStyle);\n\n    for (let frame = parentElement(element); frame !== null; frame = parentElement(frame)) {\n        if (ownerDocument !== frame.ownerDocument) {\n            ownerDocument = frame.ownerDocument;\n            ownerWindow = ownerDocument.defaultView;\n            if (!ownerWindow) {\n                break;\n            }\n\n            const { left: dX, top: dY } = frame.getBoundingClientRect();\n            top += dY;\n            right += dX;\n            bottom += dY;\n            left += dX;\n        }\n\n        const frameStyle = ownerWindow.getComputedStyle(frame);\n\n        if (frameStyle.position === \"fixed\") {\n            break;\n        }\n\n        if (!isScrollable(frame, frameStyle)) {\n            continue;\n        }\n\n        const frameRect = frame.getBoundingClientRect();\n\n        const [frameTop, frameRight, frameBottom, frameLeft] = getFrameViewport(frame, frameRect);\n\n        const eAlignH = mapNearest(alignH, frameLeft, frameRight, frame.clientWidth, left, right, right - left);\n        const eAlignV = mapNearest(alignV, frameTop, frameBottom, frame.clientHeight, top, bottom, bottom - top);\n\n        const diffX =\n            eAlignH === null ? 0 : calcAlignEdge(eAlignH, left, right) - calcAlignEdge(eAlignH, frameLeft, frameRight);\n        const diffY =\n            eAlignV === null ? 0 : calcAlignEdge(eAlignV, top, bottom) - calcAlignEdge(eAlignV, frameTop, frameBottom);\n\n        const moveX = isXReversed(frameStyle)\n            ? clamp(diffX, -frame.scrollWidth + frame.clientWidth - frame.scrollLeft, -frame.scrollLeft)\n            : clamp(diffX, -frame.scrollLeft, frame.scrollWidth - frame.clientWidth - frame.scrollLeft);\n        const moveY = clamp(diffY, -frame.scrollTop, frame.scrollHeight - frame.clientHeight - frame.scrollTop);\n\n        actions.push([\n            frame,\n            { left: frame.scrollLeft + moveX, top: frame.scrollTop + moveY, behavior: options.behavior },\n        ]);\n\n        top = Math.max(top - moveY, frameTop);\n        right = Math.min(right - moveX, frameRight);\n        bottom = Math.min(bottom - moveY, frameBottom);\n        left = Math.max(left - moveX, frameLeft);\n    }\n\n    return actions;\n};\n\nexport const scrollIntoView = (\n    element: Element,\n    scrollIntoViewOptions?: ScrollIntoViewOptions,\n    config?: IScrollConfig,\n): void => {\n    const options = scrollIntoViewOptions || {};\n\n    if (!checkBehavior(options.behavior)) {\n        throw new TypeError(failedExecuteInvalidEnumValue(\"scrollIntoView\", \"Element\", options.behavior));\n    }\n\n    const actions = computeScrollIntoView(element, options);\n\n    actions.forEach(([frame, scrollToOptions]) => {\n        elementScroll(frame, scrollToOptions, config);\n    });\n};\n\nexport const elementScrollIntoView = scrollIntoView;\n","import { backupMethod, isScrollBehaviorSupported, markPolyfill, modifyPrototypes } from \"./common.js\";\nimport type { IScrollConfig } from \"./scroll-step\";\nimport { scroll, scrollBy, scrollTo } from \"./scroll.js\";\n\ntype ScrollName = \"scroll\" | \"scrollTo\" | \"scrollBy\";\n\ntype Patch = <T extends ScrollName>(prop: T, func: (Element | typeof window)[T]) => void;\n\nconst createPolyfill =\n    (scrollName: ScrollName, patch: Patch) =>\n    (config?: IScrollConfig): void => {\n        if (isScrollBehaviorSupported(config)) {\n            return;\n        }\n\n        const scrollMethod = {\n            scroll,\n            scrollTo,\n            scrollBy,\n        }[scrollName];\n\n        patch(scrollName, function (this: Element | typeof window): void {\n            const args = arguments;\n            if (arguments.length === 1) {\n                scrollMethod(this, args[0] as ScrollToOptions, config);\n                return;\n            }\n\n            const left = args[0] as number;\n            const top = args[1] as number;\n            scrollMethod(this, { left, top });\n        });\n    };\n\nexport const elementScrollPolyfill = /* #__PURE__ */ createPolyfill(\"scroll\", modifyPrototypes);\nexport const elementScrollToPolyfill = /* #__PURE__ */ createPolyfill(\"scrollTo\", modifyPrototypes);\nexport const elementScrollByPolyfill = /* #__PURE__ */ createPolyfill(\"scrollBy\", modifyPrototypes);\n\nexport const modifyWindow = <T extends \"scroll\" | \"scrollTo\" | \"scrollBy\">(prop: T, func: typeof window[T]): void => {\n    markPolyfill(func);\n    backupMethod(window, prop);\n    window[prop] = func;\n};\n\nexport const windowScrollPolyfill = /* #__PURE__ */ createPolyfill(\"scroll\", modifyWindow);\nexport const windowScrollToPolyfill = /* #__PURE__ */ createPolyfill(\"scrollTo\", modifyWindow);\nexport const windowScrollByPolyfill = /* #__PURE__ */ createPolyfill(\"scrollBy\", modifyWindow);\n","import { backupMethod, isObject, isScrollBehaviorSupported, modifyPrototypes } from \"./common.js\";\nimport type { IScrollConfig } from \"./scroll-step\";\nimport { elementScrollIntoView } from \"./scrollIntoView.js\";\n\nfunction elementScrollIntoViewBoolean(this: Element, alignToTop?: unknown) {\n    elementScrollIntoView(this, {\n        block: alignToTop ?? true ? \"start\" : \"end\",\n        inline: \"nearest\",\n    });\n}\n\nexport const elementScrollIntoViewPolyfill = (config?: IScrollConfig): void => {\n    if (isScrollBehaviorSupported(config)) {\n        return;\n    }\n\n    const originalFunc = backupMethod(window.HTMLElement.prototype, \"scrollIntoView\", elementScrollIntoViewBoolean);\n\n    modifyPrototypes(\"scrollIntoView\", function scrollIntoView(this: Element): void {\n        const args = arguments;\n        const options = args[0] as unknown;\n\n        if (args.length === 1 && isObject(options)) {\n            elementScrollIntoView(this, options as ScrollIntoViewOptions, config);\n            return;\n        }\n\n        originalFunc.apply(this, args as never);\n    });\n};\n","import { isScrollBehaviorSupported } from \"./common.js\";\nimport type { IScrollConfig } from \"./scroll-step.js\";\nimport {\n    elementScrollByPolyfill,\n    elementScrollPolyfill,\n    elementScrollToPolyfill,\n    windowScrollByPolyfill,\n    windowScrollPolyfill,\n    windowScrollToPolyfill,\n} from \"./scroll.polyfill.js\";\nimport { elementScrollIntoViewPolyfill } from \"./scrollIntoView.polyfill.js\";\n\nexport * from \"./scroll.polyfill.js\";\nexport * from \"./scrollIntoView.polyfill.js\";\n\nexport const polyfill = (config?: IScrollConfig): void => {\n    if (isScrollBehaviorSupported(config)) {\n        return;\n    }\n\n    elementScrollPolyfill(config);\n    elementScrollToPolyfill(config);\n    elementScrollByPolyfill(config);\n    elementScrollIntoViewPolyfill(config);\n\n    windowScrollPolyfill(config);\n    windowScrollToPolyfill(config);\n    windowScrollByPolyfill(config);\n};\n"],"names":[],"mappings":"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"}